"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([[578],{6578:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var i=n(9439),a=n(7762),r=n(1413),o=n(2791),s=n(7689),l=n(4554),c=n(7247),d=n(3518),u=n(7482),p=n(3400),f=n(3768),h=n(6770),g=n(926),m=n(7064),x=n(6702),v=n(6043),y=n(7907);function Z(e){var t=new URL("".concat(window.location.origin,"/api/file"));t.searchParams.append("path",e),fetch(t.toString(),{method:"DELETE"})}function j(e,t){var n=new URL("".concat(window.location.origin,"/api/directory"));n.searchParams.append("path",("/"+e).replace(/\/\/+/g,"/")),fetch(n.toString()).then((function(e){return e.json()})).then((function(e){t({type:"update_items",items:null==e?[]:e})}))}var w=n(3717),b=n(9885),D=n(7047),S=n(9174),k=n(6098),_=n(890),C=n(2930),M=n(8096),P=n(242),E=(0,n(225).Z)(P.j)({position:"relative",objectFit:"cover",cursor:"pointer",overflow:"hidden",transitionDuration:"200ms",transform:"scale3d(1.00, 1.00, 1)","&:hover":{transitionDuration:"200ms",transform:"scale3d(1.03, 1.03, 1)"}});function R(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t?1e3:1024;if(Math.abs(e)<i)return e+" B";var a=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=-1,o=Math.pow(10,n);do{e/=i,++r}while(Math.round(Math.abs(e)*o)/o>=i&&r<a.length-1);return e.toFixed(n)+" "+a[r]}function F(e){var t=new Date(e.mediaData.CreateDate);return 0==t.getFullYear()&&(t=new Date(e.modTime)),t.toDateString()}var L=n(184),I={outline:"1px solid #00F0FF",color:"gray",backgroundColor:"lightblue"};var O=function(e){var t=e.itemData,n=e.type,i=e.isDir,a=e.imported;return i?(0,L.jsx)(w.Z,{style:{width:"80%",height:"80%",cursor:"pointer",marginBottom:"20%"},onDragOver:function(){}}):"File"==n?(0,L.jsx)(b.Z,{style:{width:"80%",height:"80%",cursor:"pointer",marginBottom:"20%"},onDragOver:function(){}}):a?(0,L.jsx)(E,{mediaData:t.mediaData,quality:"thumbnail",lazy:!0}):(0,L.jsx)(D.Z,{animation:"wave",height:"100%",width:"100%",variant:"rectangular"})},z=function(e){var t=e.dispatch,n=((0,C.Z)()||{}).focused,a=(0,o.useState)(!1),r=(0,i.Z)(a,2),s=r[0],l=r[1];return(0,o.useEffect)((function(){n||1!=s?l(n):t({type:"reject_edit"})}),[n]),(0,L.jsx)(L.Fragment,{})},B=function(e){var t=e.itemData,n=e.editing,i=e.hasInfo,a=e.setRenameVal,r=e.dispatch,s=(0,o.useMemo)((function(){return t.filepath.substring(t.filepath.lastIndexOf("/")+1)}),[t.filepath]);if(n){var c=s.lastIndexOf(".");if(-1!=c)var d=s.slice(c),u=s.slice(0,c);else u=s;return(0,L.jsxs)(M.Z,{style:{width:"90%"},children:[(0,L.jsx)(k.ZP,{autoFocus:!0,placeholder:u,onClick:function(e){e.stopPropagation()},onChange:function(e){a(e.target.value)},endAdornment:d||""}),(0,L.jsx)(z,{dispatch:r})]})}return(0,L.jsx)(f.Z,{title:s,enterNextDelay:100,children:(0,L.jsxs)(l.Z,{display:"flex",flexDirection:"column",justifyContent:"center",height:"90%",width:"90%",onClick:function(e){e.stopPropagation(),r({type:"start_editing",file:t.filepath})},children:[(0,L.jsxs)(_.Z,{noWrap:!0,style:{margin:0,color:"white",cursor:"text"},children:[s," "]}),i&&(0,L.jsxs)(l.Z,{display:"flex",justifyContent:"space-evenly",children:[(0,L.jsxs)(_.Z,{fontSize:12,noWrap:!0,style:{margin:0,color:"white",cursor:"text"},children:[R(t.size)," "]}),(0,L.jsxs)(_.Z,{fontSize:12,noWrap:!0,style:{margin:0,color:"white",cursor:"text"},children:[F(t)," "]})]})]})})};function T(e){var t,n=e.itemData,a=e.editing,r=e.dispatch,s=e.anyChecked,c=e.navigate,d=(0,o.useMemo)((function(){return!!n.mediaData}),[n.mediaData]),u=(0,o.useState)(!1),p=(0,i.Z)(u,2),f=p[0],h=p[1],g=(0,o.useState)(""),m=(0,i.Z)(g,2),x=m[0],v=m[1];(0,o.useEffect)((function(){if(a)return function(e,t,n,i){var a=function(a){if(t)switch(a.key){case"Escape":return a.preventDefault(),void e({type:"reject_edit"});case"Enter":return a.preventDefault(),void e(""==n?{type:"reject_edit"}:{type:"confirm_edit",newName:n,file:i})}};return window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a)}}(r,a,x,n.filepath)}),[a,x]);var y=(0,o.useMemo)((function(){return n.isDir?function(){return c(("/files/"+n.filepath).replace(/\/\/+/g,"/"))}:n.imported?function(){return r({type:"set_presentation",presentingPath:n.filepath})}:function(){}}),[]),Z=function(e){r({type:"set_selected",itempath:n.filepath,selected:!n.selected})};return(0,L.jsxs)(l.Z,{position:"relative",display:"flex",justifyContent:"center",height:"200px",width:"200px",overflow:"hidden",borderRadius:"10px",margin:"10px",sx:n.selected?I:{},onMouseOver:function(){return h(!0)},onMouseLeave:function(){return h(!1)},onClick:s?Z:function(){},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},children:[(f||n.selected)&&d&&(0,L.jsx)(l.Z,{width:"100%",children:(0,L.jsx)(S.Z,{name:"check",checked:n.selected,style:{position:"absolute",zIndex:2,boxShadow:"10px"},onChange:Z,onClick:function(e){e.stopPropagation()}})}),(0,L.jsx)(l.Z,{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",height:"100%",width:"100%",onClick:s?function(){}:y,children:(0,L.jsx)(O,{itemData:n,type:null===(t=n.mediaData)||void 0===t?void 0:t.MediaType.FriendlyName,isDir:n.isDir,imported:n.imported})}),(0,L.jsx)(l.Z,{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",p:"10px",bgcolor:"rgb(0, 0, 0, 0.50)",width:"inherit",height:"max-content",bottom:"0px",textAlign:"center",children:(0,L.jsx)(B,{itemData:n,editing:a,hasInfo:d,setRenameVal:v,dispatch:r})})]})}var U=n(5794),H=n(923),A=n(6133),N=n(1610),W=n(8074),q=n(5552),G=function(e){var t=Object.keys(e).map((function(t){return e[t]}));return t.sort((function(e,t){return e.mediaData&&!t.mediaData?-1:!e.mediaData&&t.mediaData||e.filepath>t.filepath?1:e.filepath<t.filepath?-1:0})),t};function Y(e){var t={};for(var n in e)t[n]=e[n];return(0,r.Z)({},e)}var J=function(e,t){switch(t.type){case"update_items":var n,o=Y(e.dirMap),s=t.items,l=(0,a.Z)(s);try{for(l.s();!(n=l.n()).done;){var c=n.value;c.selected=!1,o[c.filepath]=c}}catch($){l.e($)}finally{l.f()}return(0,r.Z)((0,r.Z)({},e),{},{dirMap:o});case"add_template_items":var d,u=Y(e.dirMap),p=(0,a.Z)(t.files);try{for(p.s();!(d=p.n()).done;){var f=d.value,h={filepath:e.path+f.name,isDir:!1,imported:!1,modTime:(new Date).toString(),selected:!1,mediaData:null};u[h.filepath]=h}}catch($){p.e($)}finally{p.f()}return(0,r.Z)((0,r.Z)({},e),{},{dirMap:u});case"set_path":var g=Y(e.dirMap),m=t.path.replace(/\/\/+/g,"/");return m!=e.path&&(g={}),(0,r.Z)((0,r.Z)({},e),{},{path:m,dirMap:g});case"set_loading":return(0,r.Z)((0,r.Z)({},e),{},{loading:t.loading});case"set_dragging":return(0,r.Z)((0,r.Z)({},e),{},{dragging:t.dragging});case"start_editing":return(0,r.Z)((0,r.Z)({},e),{},{editing:t.file});case"reject_edit":return(0,r.Z)((0,r.Z)({},e),{},{editing:""});case"confirm_edit":var x=Y(e.dirMap),v=t.file.replace(/.*?([^/]*)$/,"$1"),y=t.newName,j=t.file.replace(/(.*?)[^/]*$/,"$1"),w=v.split("."),b=(0,i.Z)(w,2),D=(b[0],b[1]);if(D){var S=y.split("."),k=(0,i.Z)(S,2),_=(k[0],k[1]);_&&_==D||(y+="."+D)}var C=j+y;return x[C]?(0,r.Z)((0,r.Z)({},e),{},{editing:""}):(function(e,t){var n=new URL("${window.location.origin}/api/file");n.searchParams.append("existingFilepath",e),n.searchParams.append("newFilepath",t),fetch(n.toString(),{method:"PUT"})}(t.file,C),x[C]=x[t.file],x[C].filepath=C,delete x[t.file],(0,r.Z)((0,r.Z)({},e),{},{dirMap:x,editing:""}));case"set_selected":var M=Y(e.dirMap),P=e.numSelected;if(e.holdingShift&&e.numSelected>0&&""!=e.lastSelected){var E=G(e.dirMap),R=E.findIndex((function(t){return t.filepath==e.lastSelected})),F=E.findIndex((function(e){return e.filepath==t.itempath}));if(F<R){var L=[F,R];R=L[0],F=L[1]}var I,O=0,z=(0,a.Z)(E.slice(R,F+1));try{for(z.s();!(I=z.n()).done;){var B=I.value;1!=M[B.filepath].selected&&(M[B.filepath].selected=!0,O+=1)}}catch($){z.e($)}finally{z.f()}P+=O}else M[t.itempath].selected=t.selected,t.selected?P+=1:P-=1;return(0,r.Z)((0,r.Z)({},e),{},{dirMap:M,numSelected:P,lastSelected:t.itempath});case"clear_selected":for(var T=Y(e.dirMap),U=0,H=Object.keys(T);U<H.length;U++){T[H[U]].selected=!1}return(0,r.Z)((0,r.Z)({},e),{},{dirMap:T,numSelected:0,lastSelected:""});case"delete_selected":for(var A=Y(e.dirMap),N=0,W=Object.keys(A);N<W.length;N++){var q=W[N];A[q].selected&&(Z(q),delete A[q])}return(0,r.Z)((0,r.Z)({},e),{},{dirMap:A,numSelected:0});case"delete_from_map":var J=Y(e.dirMap);return delete J[t.file],(0,r.Z)((0,r.Z)({},e),{},{dirMap:J});case"holding_shift":return(0,r.Z)((0,r.Z)({},e),{},{holdingShift:t.shift});case"set_presentation":return document.documentElement.style.overflow="hidden",(0,r.Z)((0,r.Z)({},e),{},{presentingPath:t.presentingPath});case"presentation_next":return(0,r.Z)({},e);case"presentation_previous":return(0,r.Z)({},e);case"stop_presenting":return document.documentElement.style.overflow="visible",(0,r.Z)((0,r.Z)({},e),{},{presentingPath:""});default:return console.error("Got unexpected dispatch type: ",t.type),(0,r.Z)({},e)}},$=function(e,t,n){e.preventDefault(),"dragenter"===e.type||"dragover"===e.type?!n&&t({type:"set_dragging",dragging:!0}):t({type:"set_dragging",dragging:!1})};var V=function(){var e=("/"+(0,s.UO)()["*"]+"/").replace(/\/\/+/g,"/"),t=(0,o.useReducer)(J,{dirMap:new Map,path:e,dragging:!1,loading:!1,presentingPath:"",numSelected:0,holdingShift:!1,lastSelected:"",editing:""}),n=(0,i.Z)(t,2),r=n[0],Z=n[1],w=(0,q.Ds)().enqueueSnackbar,b=(0,N.Z)(w),D=b.wsSend,S=b.lastMessage,k=b.readyState,_=(0,o.useState)(0),C=(0,i.Z)(_,2),M=C[0],P=C[1],E=(0,s.s0)(),R=(0,o.useState)(!1),F=(0,i.Z)(R,2),I=F[0],O=F[1],z=(0,o.useState)(null),B=(0,i.Z)(z,2),Y=B[0],V=B[1],X=function(){V(null)};(0,o.useEffect)((function(){1==k&&j(e,Z)}),[k]),(0,o.useEffect)((function(){!function(e){window.addEventListener("keydown",(function(t){"Escape"===t.key?(t.preventDefault(),e({type:"clear_selected"})):"Shift"===t.key&&e({type:"holding_shift",shift:!0})})),window.addEventListener("keyup",(function(t){"Shift"===t.key&&e({type:"holding_shift",shift:!1})}))}(Z)}),[]),(0,o.useEffect)((function(){if(S){var t=JSON.parse(S.data);switch(t.type){case"new_items":return void Z({type:"update_items",items:t.content});case"finished":return P(0),void Z({type:"set_loading",loading:!1});case"refresh":return void j(e,Z);case"scan_directory_progress":return void P(100*(1-t.remainingTasks/t.totalTasks));case"error":return"upload_error"==t.error&&Z({type:"delete_from_map",file:t.content.File}),void w(t.content.Message,{variant:"error"});default:return void console.error("Got unexpected websocket message type: ",t.type)}}}),[S]),(0,o.useEffect)((function(){O(!1),Z({type:"set_path",path:e}),Z({type:"set_loading",loading:!1}),Z({type:"clear_selected"}),P(0),j(e,Z)}),[e]);var K=(0,o.useMemo)((function(){var t=G(r.dirMap),n=r.numSelected>0,i=!1,a=t.map((function(e){return!e.mediaData||e.imported||e.isDir||(i=!0),(0,L.jsx)(l.Z,{children:(0,L.jsx)(T,{itemData:e,editing:r.editing==e.filepath,dispatch:Z,anyChecked:n,navigate:E})},e.filepath)}));return i&&!I&&(O(!0),Z({type:"set_loading",loading:!0}),(0,N.y)(e,D,!1)),a}),[r.dirMap,r.editing]);return(0,L.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,L.jsx)(H.Z,{dispatch:Z,wsSend:D,page:"files"}),(0,L.jsxs)(l.Z,{onDragOver:function(e){return $(e,Z,r.dragging)},onDragLeave:function(e){return $(e,Z,r.dragging)},onDrop:function(t){return function(e,t,n,i,r,o){e.preventDefault(),e.stopPropagation(),i({type:"set_dragging",dragging:!1});var s,l=[],c=(0,a.Z)(e.dataTransfer.files);try{for(c.s();!(s=c.n()).done;){var d=s.value;n[t+d.name]?o(d.name+" already exists in this directory",{variant:"error"}):l.push(d)}}catch(u){c.e(u)}finally{c.f()}i({type:"add_template_items",files:l}),0!=l.length&&(i({type:"set_loading",loading:!0}),(0,A.Z)(l,t,r))}(t,e,r.dirMap,Z,D,w)},bgcolor:r.dragging?"rgb(200, 200, 200)":"white",display:"flex",flexDirection:"column",alignItems:"center",paddingLeft:0,paddingRight:0,minHeight:"max-content",height:"93vh",sx:{outline:r.dragging?"rgb(54, 147, 255) solid 2px":"",outlineOffset:"-10px"},onContextMenu:function(e){e.preventDefault(),V(null===Y?{mouseX:e.clientX+2,mouseY:e.clientY-6}:null)},children:[""!=r.presentingPath&&(0,L.jsx)(U.Z,{mediaData:r.dirMap[r.presentingPath].mediaData,dispatch:Z}),r.loading&&(0,L.jsxs)(l.Z,{sx:{width:"100%"},children:[0==M&&(0,L.jsx)(u.Z,{}),0!=M&&(0,L.jsxs)(l.Z,{sx:{width:"100%"},children:[(0,L.jsx)(u.Z,{variant:"determinate",value:M}),(0,L.jsx)("p",{style:{position:"absolute",left:"6vw"},children:"Syncing filesystem with database..."})]})]}),r.numSelected>0&&(0,L.jsxs)(l.Z,{position:"absolute",display:"flex",left:"5vw",children:[(0,L.jsx)(p.Z,{style:{padding:"15px"},onClick:function(){Z({type:"clear_selected"})},children:(0,L.jsx)(f.Z,{title:"Unselect All (esc)",children:(0,L.jsx)(v.Z,{badgeContent:r.numSelected,color:"secondary",children:(0,L.jsx)(y.Z,{color:"action"})})})}),(0,L.jsx)(p.Z,{style:{padding:"15px"},onClick:function(){!function(e,t){for(var n=[],i=0,a=Object.values(e);i<a.length;i++){var r=a[i];r.selected&&n.push(r.filepath)}console.log(n);var o=new URL("".concat(window.location.origin,"/api/takeout"));fetch(o.toString(),{method:"POST",body:JSON.stringify({items:n,path:t})}).then((function(e){return e.json()})).then((function(e){fetch("".concat(o.toString(),"/").concat(e.takeoutId)).then((function(e){return 200!=e.status?Promise.reject():e.blob()})).then((function(t){var n=document.createElement("a");n.setAttribute("download","".concat(e.takeoutId,".zip"));var i=URL.createObjectURL(t);n.href=i,n.setAttribute("target","_blank"),n.click(),URL.revokeObjectURL(i)}),(function(e){return console.error("Could not download takeout")}))}))}(r.dirMap,e)},children:(0,L.jsx)(f.Z,{title:"Download Selected",children:(0,L.jsx)(d.Z,{})})}),(0,L.jsx)(p.Z,{style:{padding:"15px"},onClick:function(){Z({type:"delete_selected"})},children:(0,L.jsx)(f.Z,{title:"Delete Selected",children:(0,L.jsx)(c.Z,{})})})]}),(0,L.jsx)(l.Z,{marginTop:2,marginBottom:2,width:"max-content",children:(0,L.jsx)(W.Z,{path:r.path,includeHome:!0,navigate:E})}),(0,L.jsx)(l.Z,{display:"flex",justifyContent:"center",width:"100%",children:(0,L.jsx)(l.Z,{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"90%",height:"100%",justifyContent:"flex-start",children:K})}),(0,L.jsx)(h.Z,{open:null!==Y,onClose:X,anchorReference:"anchorPosition",anchorPosition:null!==Y?{top:Y.mouseY,left:Y.mouseX}:void 0,children:(0,L.jsxs)(g.Z,{onClick:function(){X(),function(e,t){console.log("HJERE");var n=new URL("".concat(window.location.origin,"/api/directory"));n.searchParams.append("path",("/"+e).replace(/\/\/+/g,"/")),console.log("AFTR"),fetch(n.toString(),{method:"POST"}).then((function(){return j(e,t)}))}(e,Z),console.log("ESCAPE"),Z({type:"start_editing",file:e})},children:[(0,L.jsx)(m.Z,{children:(0,L.jsx)(x.Z,{})}),"New Folder"]})})]})]})}},6133:function(e,t,n){var i=n(7762),a=function(e,t,n){console.log("Inside!"),n(JSON.stringify({type:"file_upload",content:{path:t,file:e}}))};function r(e){return new Promise((function(t,n){var i=new FileReader;i.onload=function(){console.log("HERE"),t({name:e.name,item64:i.result})},i.onerror=function(){n(i)},i.readAsDataURL(e)}))}t.Z=function(e,t,n){var o,s=(0,i.Z)(e);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.size>2e9&&console.log("This upload is going to fail"),r(l).then((function(e){return a(e,t,n)}))}}catch(c){s.e(c)}finally{s.f()}}},1610:function(e,t,n){n.d(t,{Z:function(){return s},y:function(){return l}});var i=n(9439),a=n(2791),r=n(9829),o=n(5552);function s(e){var t="ws://".concat(window.location.host,"/api/ws"),n=(0,a.useState)(null),s=(0,i.Z)(n,2),l=s[0],c=s[1],d=(0,a.useState)(null),u=(0,i.Z)(d,2),p=u[0],f=u[1],h=(0,r.ZP)(t,{onOpen:function(){clearTimeout(l),p&&((0,o.sy)(p),e("Websocket reconnected",{variant:"success"}),f(null)),console.log("WebSocket connection established.")},onClose:function(){p||l||c(setTimeout((function(){f(e("No connection to websocket, retrying...",{variant:"error",persist:!0,preventDuplicate:!0}))}),2e3))},reconnectAttempts:25,reconnectInterval:function(e){return 1e3*(2^e)},shouldReconnect:function(){return!0},onReconnectStop:function(){clearTimeout(l),(0,o.sy)(p),f(e("Unable to connect websocket. Please refresh your page",{variant:"error",persist:!0,preventDuplicate:!0}))}}),g=h.sendMessage;return{wsSend:function(e){g(e)},lastMessage:h.lastMessage,readyState:h.readyState}}function l(e,t,n){console.log("Doing sync"),t(JSON.stringify({type:"scan_directory",content:{path:e,recursive:n}}))}},8074:function(e,t,n){n.d(t,{j:function(){return p}});var i=n(9439),a=n(7762),r=n(1918),o=n(7107),s=n(2065),l=n(3517),c=n(4554),d=n(184),u=(0,o.Z)({palette:{primary:{main:"#1976d2",contrastText:"white"}},typography:{fontWeightRegular:"12px"}}),p=function(e){var t,n=e.label,i=e.success,a=e.onClick;return t=i?"rgb(0, 255, 0)":"rgb(230, 230, 230)",(0,d.jsx)(c.Z,{height:"max-content",width:"100%",onClick:a,sx:{cursor:"pointer"},children:(0,d.jsx)(r.Z,{label:n,sx:{width:"100%",backgroundColor:t,height:25,color:"white",fontWeight:u.typography.fontWeightRegular,"&:hover, &:focus":{backgroundColor:(0,s._4)(t,.1)},"&:active":{boxShadow:u.shadows[1],backgroundColor:(0,s._4)(t,.12)}}})})};t.Z=function(e){var t=e.path,n=e.includeHome,r=e.navigate;if(!t)return null;try{for(var o=(t=t.slice(1)).split("/");""==o[o.length-1];)o.pop();n&&o.unshift("/");var s,c=o.pop(),u=[],f=(0,a.Z)(o.entries());try{for(f.s();!(s=f.n()).done;){var h=(0,i.Z)(s.value,2),g=h[0],m=h[1];0==g&&n?u.push("/"):u.push(u[g-1]+"/"+m)}}catch(v){f.e(v)}finally{f.f()}var x=o.map((function(e,t){return(0,d.jsx)(p,{label:"/"==e?"Home":e,success:!1,onClick:function(){r("/files/".concat(u[t]).replace(/\/\/+/g,"/"))}},e)}));return x.push((0,d.jsx)(p,{label:"/"==c?"Home":c,success:!1,onClick:function(){}},c)),(0,d.jsx)(l.Z,{separator:"\u203a",children:x})}catch(v){return console.log(v),null}}},923:function(e,t,n){var i=n(9439),a=n(4942),r=n(2791),o=n(4395),s=n(4663),l=n(3400),c=n(9013),d=n(1799),u=n(6488),p=n(4554),f=n(3717),h=n(5456),g=n(3768),m=n(7689),x=n(6133),v=n(1610),y=n(6934),Z=n(2065),j=n(6098),w=n(5403),b=n(1600),D=n(184),S=(0,y.ZP)("div")((function(e){var t=e.theme;return(0,a.Z)({position:"relative",borderRadius:t.shape.borderRadius,backgroundColor:(0,Z.Fq)(t.palette.common.white,.15),"&:hover":{backgroundColor:(0,Z.Fq)(t.palette.common.white,.25)},marginLeft:0,width:"100%"},t.breakpoints.up("sm"),{marginLeft:t.spacing(1),width:"auto"})})),k=(0,y.ZP)("div")((function(e){return{padding:e.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),_=(0,y.ZP)(j.ZP)((function(e){var t=e.theme;return{color:"inherit","& .MuiInputBase-input":(0,a.Z)({padding:t.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(t.spacing(4),")"),transition:t.transitions.create("width"),width:"100%"},t.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})}})),C=(0,r.memo)((function(e){var t=e.dispatch,n=e.wsSend,a=e.page,r=(0,b.Z)(["weblens-login-token"]),y=(0,i.Z)(r,3),Z=(y[0],y[1],y[2]),j=(0,m.s0)(),C=((0,m.UO)()["*"]+"/").replace(/\/\/+/g,"/");return"gallery"==a&&(C="/"),(0,D.jsx)(p.Z,{sx:{flexGrow:1},zIndex:1,pt:1,maxWidth:"100vw",children:(0,D.jsx)(o.Z,{position:"static",color:"transparent",style:{boxShadow:"none"},children:(0,D.jsxs)(s.Z,{style:{paddingLeft:"25px"},children:["gallery"==a&&(0,D.jsx)(g.Z,{title:"Files",children:(0,D.jsx)(l.Z,{href:"/files/",edge:"start",color:"inherit","aria-label":"files",style:{margin:10,flexDirection:"column",fontSize:20},children:(0,D.jsx)(f.Z,{})})}),"files"==a&&(0,D.jsx)(g.Z,{title:"Gallery",children:(0,D.jsx)(l.Z,{href:"/",edge:"start",color:"inherit","aria-label":"files",style:{margin:15,flexDirection:"column",fontSize:20},children:(0,D.jsx)(h.Z,{})})}),(0,D.jsx)(g.Z,{title:"Sync",children:(0,D.jsx)(l.Z,{onClick:function(){t({type:"set_loading",loading:!0}),(0,v.y)(C,n,!0)},edge:"start",color:"inherit","aria-label":"upload",style:{margin:10,flexDirection:"column",fontSize:20},children:(0,D.jsx)(d.Z,{})})}),(0,D.jsx)(g.Z,{title:"Upload",children:(0,D.jsxs)(l.Z,{edge:"start",color:"inherit","aria-label":"upload",style:{margin:10,flexDirection:"column",fontSize:20},children:[(0,D.jsx)("input",{id:"upload-image",hidden:!0,accept:"image/*",type:"file",onChange:function(e){return(0,x.Z)(e.target.files[0],"/",null)}}),(0,D.jsx)(c.Z,{})]})}),(0,D.jsxs)(S,{children:[(0,D.jsx)(k,{children:(0,D.jsx)(w.Z,{})}),(0,D.jsx)(_,{placeholder:"Search\u2026",inputProps:{"aria-label":"search"},onChange:function(e){return t({type:"set_search",search:e.target.value})}})]}),(0,D.jsx)(g.Z,{title:"Logout",children:(0,D.jsx)(l.Z,{edge:"end",color:"inherit","aria-label":"logout",style:{margin:10,flexDirection:"column",fontSize:20},onClick:function(){Z("weblens-login-token"),j("/login")},children:(0,D.jsx)(u.Z,{})})})]})})})}));t.Z=C},242:function(e,t,n){n.d(t,{j:function(){return g}});var i=n(1413),a=n(5987),r=n(9439),o=n(2791),s=n(5218),l=n(4554),c=n(3239),d=n(225),u=n(184),p=["mediaData","quality","lazy"],f=(0,d.Z)(l.Z)({top:0,left:0,height:"100%",width:"100%",display:"flex",position:"absolute",justifyContent:"center",overflow:"hidden",objectFit:"contain"}),h=(0,d.Z)(c.Z)({position:"absolute",zIndex:1,bottom:"10px",right:"10px",color:"rgb(255, 255, 255)"});var g=function(e){var t=e.mediaData,n=e.quality,l=e.lazy,c=(0,a.Z)(e,p),d=(0,o.useState)(!1),g=(0,r.Z)(d,2),m=g[0],x=g[1],v=(0,o.useRef)(),y=function(e){var t=(0,o.useState)(!1),n=(0,r.Z)(t,2),i=n[0],a=n[1];return(0,o.useEffect)((function(){var t=new IntersectionObserver((function(e){var t=(0,r.Z)(e,1)[0];a(t.isIntersecting)}),{rootMargin:"1000px"});return t.observe(e.current),function(){t.disconnect()}}),[e]),i}(v),Z=new URL("".concat(window.location.origin,"/api/item/").concat(t.FileHash));return Z.searchParams.append(n,"true"),(0,u.jsxs)(f,{ref:v,children:[!m&&(0,u.jsx)(h,{size:20}),(0,u.jsx)("img",(0,i.Z)((0,i.Z)({height:"100%",width:"100%",loading:l?"lazy":"eager"},c),{},{src:Z.toString(),style:{position:"absolute",display:y?"block":"none"},onLoad:function(){x(!0)}})),t.BlurHash&&l&&!m&&(0,u.jsx)(s.E,{style:{position:"absolute"},height:250,width:550,hash:t.BlurHash})]})}},5794:function(e,t,n){var i=n(2791),a=n(4554),r=n(3400),o=n(9823),s=n(225),l=n(9885),c=n(8074),d=n(242),u=n(184),p=(0,s.Z)(a.Z)({position:"fixed",display:"flex",justifyContent:"center",alignItems:"center",color:"white",top:0,left:0,padding:"25px",height:"calc(100vh - 50px)",width:"calc(100vw - 50px)",zIndex:3,backgroundColor:"rgb(0, 0, 0, 0.92)"}),f=(0,s.Z)(d.j)({height:"calc(100% - 40px)",width:"calc(100% - 40px)",objectFit:"contain",margin:"20px"}),h=function(e){var t,n=e.mediaData;return n?n.MediaType.IsVideo?(0,u.jsx)(f,{mediaData:n,quality:"thumbnail",lazy:!1},"".concat(n.FileHash," thumbnail")):"File"==(null===(t=n.MediaType)||void 0===t?void 0:t.FriendlyName)?(0,u.jsx)(l.Z,{style:{width:"80%",height:"80%"},onDragOver:function(){}}):(0,u.jsxs)("div",{style:{height:"100%",width:"100%"},children:[(0,u.jsx)(f,{mediaData:n,quality:"thumbnail",lazy:!1},"".concat(n.FileHash," thumbnail")),(0,u.jsx)(f,{mediaData:n,quality:"fullres",lazy:!1},"".concat(n.FileHash," fullres"))]}):void 0};t.Z=function(e){var t=e.mediaData,n=e.dispatch;return(0,i.useEffect)((function(){return function(e){console.log("AHH");var t=function(t){"Escape"===t.key&&(t.preventDefault(),e({type:"stop_presenting"})),"ArrowLeft"===t.key&&(t.preventDefault(),e({type:"presentation_previous"})),"ArrowRight"===t.key&&(t.preventDefault(),e({type:"presentation_next"}))};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}(n)}),[]),(0,u.jsxs)(p,{children:[(0,u.jsx)(h,{mediaData:t}),(0,u.jsx)(r.Z,{onClick:function(){return n({type:"stop_presenting"})},color:"inherit",sx:{display:"block",position:"absolute",top:15,left:15,cursor:"pointer",zIndex:100},children:(0,u.jsx)(o.Z,{})}),(0,u.jsx)(a.Z,{position:"absolute",top:10,children:(0,u.jsx)(c.Z,{path:null===t||void 0===t?void 0:t.Filepath,includeHome:!1,navigate:function(){}})})]})}}}]);
//# sourceMappingURL=578.42b9ee9c.chunk.js.map